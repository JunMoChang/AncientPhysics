# 故理 - 解谜游戏

*我的第一个完整游戏作品*


------

## 项目简介

这是我为参加**中国大学计算机大赛**制作的第一款完整游戏。灵感来源于《墨经》中的物理学记载,希望通过游戏的形式展现中国古代的科学智慧。

玩家扮演一个现代初中生,穿越到古代,需要利用杠杆、滑轮、小孔成像等物理原理解开谜题。

### 演示视频

 [B站演示](https://www.bilibili.com/video/BV1XmkxBeESV)

------

## 游戏特色

### 物理机制设计

游戏包含三种主要物理机制:

#### 1. 杠杆平衡

> 《墨经·经下》: "衡,加重于其一旁,必捶,权重相若也"

**实现方式:**

- 使用 Unity 的 **Rigidbody** 和 **HingeJoint** 组件
- 通过检测杠杆的旋转角度和角速度判断是否平衡
- 玩家需要在两端放置重物使杠杆保持水平

#### 2. 滑轮系统

> 《墨经·经下》: "挈,长重者下,短轻者上"

**实现方式:**

- 使用 **Obi Rope** 插件模拟绳索物理
- 通过 HingeJoint 实现滑轮旋转
- 玩家在绳子一端加重物来提升另一端的物体

#### 3. 小孔成像

> 《墨经·经下》: "景:光之人煦若射,下者之人也高,高者之人也下"

**实现方式:**

- 使用 URP 的 **Decal Projector** 投影倒立的图像
- 通过射线检测判断光源是否被遮挡
- 根据物距和像距计算成像大小(缩放因子 = 物距/像距)

------

## 游戏内容

### 关卡设计

| 关卡       | 机制     | 目标                  |
| ---------- | -------- | --------------------- |
| **第一关** | 杠杆平衡 | 让3个杠杆同时保持平衡 |
| **第二关** | 滑轮组   | 用滑轮提升重物        |
| **第三关** | 小孔成像 | 调整光源位置完成成像  |

### 操作方式

| 操作      | 按键            |
| --------- | --------------- |
| 移动      | W/A/S/D         |
| 视角旋转  | 鼠标右键 + 移动 |
| 拾取/交互 | 鼠标左键        |
| 拖拽物体  | 左键按住拖动    |
| 缩放视野  | 鼠标滚轮        |
| 暂停      | ESC             |

------

## 技术实现

### 开发环境

| 工具     | 版本            |
| -------- | --------------- |
| Unity    | 2022 LTS        |
| 渲染管线 | URP             |
| 开发工具 | JetBrains Rider |

### 主要插件

- **Obi Rope**: 绳索物理模拟
- **Zenject**: 依赖注入(用于拖拽系统)
- **Cinemachine**: 相机控制

### 核心系统

```
游戏架构
├── 玩家控制 (PlayerController.cs)
│   └── CharacterController + 自定义重力
│
├── 交互系统
│   ├── 射线检测点击 (RayInteraction.cs)
│   └── 拖拽系统 (DragInteraction.cs)
│       └── 工厂模式创建不同拖拽方式
│
├── 物理谜题
│   ├── 杠杆 (PlankController.cs + BalanceCondition.cs)
│   ├── 滑轮 (PulleyRotation.cs + RopeController.cs)  
│   └── 小孔成像 (KeyholeProjector.cs)
│
└── 管理系统
    ├── GameManager (场景管理)
    ├── UIManager (UI栈管理)
    ├── DialogueManager (对话系统)
    └── EventsManager (事件通知)
```

### 使用的设计模式

- **单例模式**: GameManager, UIManager 等管理器
- **工厂模式**: 根据物体类型创建不同的拖拽行为
- **观察者模式**: EventsManager 实现事件订阅
- **依赖注入**: Zenject 管理拖拽系统依赖

------

## 美术资源

**场景搭建:**

- 使用 Unity **ProBuilder** 快速搭建几何体
- 应用了一些基础材质
- 整体比较简单,但能表达意图

**UI设计:**

- 竹简风格的对话框
- 简单的按钮和面板
- 有打字机效果的文字显示

**光照:**

- URP 的默认光照
- 暖黄色主光源
- 一些点光源(蜡烛等)

------

## 项目结构

```
故理/
├── Assets/
│   ├── Scenes/              # 场景文件
│   ├── Script/              # C# 脚本
│   │   ├── Player/          # 玩家控制
│   │   ├── Pry/             # 杠杆系统
│   │   ├── Pulley/          # 滑轮系统
│   │   ├── KeyholeImage/    # 小孔成像
│   │   └── Tools/           # 工具和管理器
│   ├── Resources/           # 资源
│   └── Shaders/             # 自定义Shader
└── README.md
```

------

## 运行项目

### 环境要求

- Unity 2022 LTS
- Obi Rope (需从 Asset Store 购买)
- Zenject (免费)

### 步骤

1. **克隆项目**

```bash
git clone [你的仓库地址]
```

1. **用 Unity Hub 打开**
2. **导入插件**
   - 从 Asset Store 导入 Obi Rope
   - Package Manager 安装 Cinemachine
3. **运行**
   - 打开 `Scenes/StartMenu` 场景
   - 点击 Play

------

## 个人收获

**Unity 技能:**

- 物理系统的基本应用(Rigidbody, HingeJoint)
- 第一人称控制器实现
- 射线检测和物体交互
- 场景管理和状态持久化
- UI系统和对话流程

**编程能力:**

- 设计模式的实践(单例、工厂、观察者)
- 事件驱动架构
- 协程的使用
- 依赖注入的概念

**项目管理:**

- 从零到一完成完整项目
- 时间管理和功能取舍
- Bug追踪和调试能力

------

## 🐛 存在的问题

#### 代码方面

- ⚠️ 有很多注释掉的代码没删
- ⚠️ 部分功能没实现完(比如 RopeController 里的粒子拖拽)
- ⚠️ 缺少错误处理
- ⚠️ 代码注释不够

#### 物理方面

- ⚠️ **没有真正的力矩计算**,只是角度判断
- ⚠️ 杠杆平衡不够真实,有时候会穿透
- ⚠️ 绳索物理偶尔会抖动
- ⚠️ 主要靠 Unity 自带物理引擎,我没深入研究

#### 游戏性

- ⚠️ 关卡太少(只有4关)
- ⚠️ 没有教学引导
- ⚠️ 难度曲线不明显
- ⚠️ 缺少反馈和提示

#### 美术

- ⚠️ **场景很简陋**(ProBuilder 搭的基础几何体)
- ⚠️ 材质很基础
- ⚠️ 没有精美的模型
- ⚠️ UI 比较粗糙

### 如果有时间会改进

- [ ] 重构代码,删除冗余部分
- [ ] 实现真正的力矩计算
- [ ] 优化物理稳定性
- [ ] 添加更多关卡
- [ ] 改善美术表现
- [ ] 添加音效和BGM

------

## 开发感想

这是我的第一个完整游戏,为了参加**中国大学计算机大赛**花了大约2个月时间完成。

### 最大的收获

**从0到1的过程:**
 以前只是跟着教程做一些小demo,这次是第一次独立完成整个项目。从策划、开发、调试到最后打包,体验了完整的开发流程。

**技术成长:**
 学会了很多Unity的核心功能,理解了游戏架构的重要性。虽然实现得不够完美,但建立了基本的开发思维。

**认识到不足:**

- 物理学知识储备不够,很多原理只是大概理解
- 美术能力欠缺,场景搭建能力有限
- 项目规划不够好,导致后期时间紧张

### 印象最深的Bug

场景切换时玩家会传送到奇怪的位置,调试了两天才发现是单例的生命周期问题

### 最满意的部分

事件驱动的架构虽然一开始写起来麻烦,但后期添加功能确实方便了很多。

### 如果重新开始

- 会先做更详细的规划
- 更早引入版本控制
- 功能设计更简单,专注把核心做好
- 不要试图做所有事情,先做能做好的

------

## 🏆 比赛经历

**赛事**: 中国大学计算机大赛 - 游戏设计与开发赛道
 **作品**: 《故理》
 **开发时长**: 约2个月

虽然游戏还有很多不足,但能完整做出来并参赛,对我来说已经是很大的进步了。

------

## 📚 参考资料

**灵感来源:**

- 《墨经》的物理学记载
- Unity官方文档

**主要学习资源:**

- Brackeys 的 Unity 教程
- Unity Learn 平台
- Stack Overflow 和 Unity 论坛

------

## 🤝 欢迎交流

如果你也是游戏开发新手,欢迎一起交流学习!

**联系方式:**

- GitHub: [@your-username](https://github.com/your-username)
- 邮箱: your.email@example.com

**反馈:**

- 如果发现bug或有建议,欢迎提 [Issues](https://github.com/your-username/GU_LI/issues)
- 如果这个项目对你有帮助,给个 ⭐ Star 吧!

------

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](https://claude.ai/chat/LICENSE)

------

## 🙏 致谢

**感谢:**

- Unity Technologies 和开发者社区
- Obi Solutions 的物理插件
- 所有提供教程的UP主们
- 中国大学计算机大赛提供的平台

**特别感谢:**

- 《墨经》的古代智慧给了我灵感
- 各种在线教程帮我解决了无数问题
